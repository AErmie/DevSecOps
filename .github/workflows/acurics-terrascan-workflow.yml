# This is a basic workflow to help you get started with Actions

name: CI

# Controls when the action will run. 
on:
  # Triggers the workflow on push or pull request events but only for the main branch
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "build"
  build:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
      - uses: actions/checkout@v2

      - name: Terrascan IaC scanner
        # You may pin to the exact commit or the version.
        # uses: accurics/terrascan-action@2fee8bc04097dd4d4a5cf5bc5dffce47d71a34de
        uses: accurics/terrascan-action@v1
        with:
          # path to a directory containing one or more IaC files (default ".")
          iac_dir: . # optional, default is .
          # IaC type (helm, k8s, kustomize, terraform)
          iac_type: terraform
          # IaC version (helm: v3, k8s: v1, kustomize: v3, terraform: v12, v14)
#           iac_version: # optional
          # policy path directory for custom policies
#           policy_path: # optional
          # policy type (all, aws, azure, gcp, github, k8s) (default all)
          policy_type: all # optional
          # one or more rules to skip while scanning (example: "ruleID1,ruleID2")
#           skip_rules: # optional
          # config file path
#           config_path: # optional
          # the action will only warn and not error when violations are found
          only_warn: false # optional
